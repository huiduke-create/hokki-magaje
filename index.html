<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LOH Hockey Manager</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #1e1e1e;
            color: white;
            font-family: 'Courier New', monospace;
            padding: 20px;
            min-height: 100vh;
            transform: scale(0.78);
            transform-origin: top center;
            width: 100%;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .game-title {
            text-align: center;
            font-size: 3em;
            margin-bottom: 15px;
            color: #ff6b6b;
            text-shadow: 2px 2px 4px #000;
        }
        
        .season-info {
            text-align: center;
            font-size: 1.4em;
            margin-bottom: 25px;
            color: #ffd166;
        }
        
        .calendar {
            text-align: center;
            font-size: 1.3em;
            margin-bottom: 20px;
            color: #4ecdc4;
            background: #333;
            padding: 15px;
            border-radius: 10px;
        }
        
        .screen {
            display: none;
            background: #2a2a2a;
            border-radius: 25px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        
        .active {
            display: block;
        }
        
        .team-select {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .team-card {
            background: #333;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            font-size: 1.1em;
        }
        
        .team-card:hover {
            border-color: #4ecdc4;
            transform: translateY(-2px);
        }
        
        .team-emoji {
            font-size: 4em;
            margin: 15px 0;
        }
        
        .player-list {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }
        
        .player-card {
            background: #333;
            padding: 15px;
            border-radius: 10px;
            font-size: 1em;
        }
        
        .player-emoji {
            font-size: 2em;
            margin-right: 10px;
        }
        
        .coach-emoji {
            font-size: 2.5em;
            margin-right: 15px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: #333;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            font-size: 1.1em;
        }
        
        .match-log {
            background: #1a1a1a;
            border-radius: 15px;
            padding: 20px;
            min-height: 250px;
            max-height: 400px;
            overflow-y: auto;
            font-size: 1em;
            line-height: 1.4;
            margin: 20px 0;
        }
        
        .hockey-rink {
            background: #e6f7ff;
            border-radius: 25px;
            padding: 40px;
            margin: 25px 0;
            position: relative;
            height: 250px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 4px solid #4ecdc4;
        }
        
        .center-line {
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 3px;
            background: #1e1e1e;
            transform: translateX(-50%);
        }
        
        .score {
            font-size: 5em;
            font-weight: bold;
            color: #1e1e1e;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .team-name-rink {
            position: absolute;
            top: 15px;
            font-weight: bold;
            color: #1e1e1e;
            font-size: 1.2em;
        }
        
        .left-team {
            left: 25px;
        }
        
        .right-team {
            right: 25px;
        }
        
        button {
            padding: 15px 25px;
            border: none;
            border-radius: 12px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Courier New', monospace;
            margin: 8px;
        }
        
        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .primary-btn {
            background: #118ab2;
            color: white;
        }
        
        .success-btn {
            background: #06d6a0;
            color: white;
        }
        
        .danger-btn {
            background: #ff6b6b;
            color: white;
        }
        
        .warning-btn {
            background: #ffd166;
            color: #333;
        }
        
        .leaderboard {
            background: #333;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .leaderboard-row {
            display: grid;
            grid-template-columns: 40px 1fr 60px 60px 60px;
            gap: 15px;
            padding: 10px;
            border-bottom: 1px solid #444;
            font-size: 1.1em;
        }
        
        .leaderboard-header {
            font-weight: bold;
            background: #444;
            border-radius: 8px;
        }
        
        .playoff-bracket {
            background: #333;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        .playoff-match {
            background: #444;
            padding: 15px;
            margin: 15px 0;
            border-radius: 10px;
            font-size: 1.1em;
        }
        
        .series-score {
            color: #ffd166;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .champion {
            text-align: center;
            font-size: 2.5em;
            color: #ffd166;
            margin: 25px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .market-item {
            background: #333;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            font-size: 1.1em;
        }
        
        .market-item:hover {
            border-color: #ffd166;
        }
        
        .budget {
            text-align: center;
            font-size: 1.4em;
            margin: 15px 0;
            color: #ffd166;
            font-weight: bold;
        }
        
        .match-results {
            background: #333;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .match-result {
            padding: 8px 0;
            border-bottom: 1px solid #444;
            font-size: 1.1em;
        }
        
        .version {
            text-align: center;
            color: #666;
            margin-top: 25px;
            font-size: 1em;
        }
        
        .daily-schedule {
            background: #333;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .schedule-item {
            padding: 10px;
            border-bottom: 1px solid #444;
        }
        
        /* –¶–≤–µ—Ç–∞ –¥–ª—è –ª–æ–≥–æ–≤ */
        .goal { color: #06d6a0; font-weight: bold; }
        .save { color: #4ecdc4; font-weight: bold; }
        .attack { color: #ffd166; }
        .period { color: #ffd166; font-weight: bold; }
        .overtime { color: #ff6b6b; font-weight: bold; }
        .money { color: #ffd166; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="game-title">üèí LOH HOCKEY MANAGER</h1>
        <div class="season-info" id="seasonInfo">–°–µ–∑–æ–Ω: 2023 | –≠—Ç–∞–ø: –†–µ–≥—É–ª—è—Ä–Ω—ã–π —Å–µ–∑–æ–Ω</div>
        <div class="calendar" id="calendarInfo">1 —Å–µ–Ω—Ç—è–±—Ä—è 2023</div>
        
        <!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
        <div id="mainMenu" class="screen active">
            <h2>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º:</h2>
            <button class="primary-btn" onclick="startTournament()" style="width: 100%; margin: 15px 0; padding: 25px;">
                üèÜ –ù–ê–ß–ê–¢–¨ –¢–£–†–ù–ò–†
            </button>
        </div>
        
        <!-- –í—ã–±–æ—Ä –∫–æ–º–∞–Ω–¥—ã -->
        <div id="teamSelect" class="screen">
            <h2>–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:</h2>
            <div class="team-select" id="teamSelectGrid">
                <!-- –ö–æ–º–∞–Ω–¥—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>
        
        <!-- –ú–µ–Ω–∂–º–µ–Ω—Ç –∫–æ–º–∞–Ω–¥—ã -->
        <div id="teamManagement" class="screen">
            <div class="budget">–ë–Æ–î–ñ–ï–¢: <span id="budgetValue">0</span> –†–£–ë</div>
            <h2 id="currentTeamName">–ö–æ–º–∞–Ω–¥–∞</h2>
            
            <!-- –¢–£–†–ù–ò–†–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê –í–°–ï–ì–î–ê –ù–ê –ì–õ–ê–í–ù–û–ú –≠–ö–†–ê–ù–ï -->
            <div class="leaderboard">
                <h3>üèÜ –¢–£–†–ù–ò–†–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê</h3>
                <div class="leaderboard-row leaderboard-header">
                    <div>#</div>
                    <div>–ö–û–ú–ê–ù–î–ê</div>
                    <div>–ò</div>
                    <div>–í</div>
                    <div>–û</div>
                </div>
                <div id="mainScreenLeaderboard">
                    <!-- –†–µ–π—Ç–∏–Ω–≥ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
            
            <div class="daily-schedule">
                <h3>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è:</h3>
                <div id="dailySchedule">
                    <!-- –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
            
            <div class="stats">
                <div class="stat-card">
                    <div>–¢–†–ï–ù–ï–†</div>
                    <div><span class="coach-emoji" id="coachEmoji">üë®‚Äçüíº</span> <span id="coachName">–ò–º—è</span></div>
                    <div>–°–¢: <span id="coachSkill">1.0</span></div>
                </div>
                <div class="stat-card">
                    <div>–ö–û–ú–ê–ù–î–ù–´–ï –°–¢–ê–¢–´</div>
                    <div>–°–ê: <span id="teamSA">0</span></div>
                    <div>–°–ó: <span id="teamSZ">0</span></div>
                </div>
            </div>
            
            <h3>–°–æ—Å—Ç–∞–≤:</h3>
            <div class="player-list" id="playerList">
                <!-- –ò–≥—Ä–æ–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
            </div>
            
            <button class="warning-btn" onclick="openMarket()">üìà –†–´–ù–û–ö –ò–ì–†–û–ö–û–í</button>
            <button class="primary-btn" id="nextDayBtn" onclick="nextDay()">‚û°Ô∏è –°–õ–ï–î–£–Æ–©–ò–ô –î–ï–ù–¨</button>
        </div>
        
        <!-- –†—ã–Ω–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ -->
        <div id="playerMarket" class="screen">
            <h2>üìà –†–´–ù–û–ö –ò–ì–†–û–ö–û–í</h2>
            <div class="budget">–ë–Æ–î–ñ–ï–¢: <span id="marketBudget">0</span> –†–£–ë</div>
            <div id="marketPlayers">
                <!-- –ò–≥—Ä–æ–∫–∏ —Ä—ã–Ω–∫–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
            </div>
            <button class="primary-btn" onclick="closeMarket()">‚Üê –ù–ê–ó–ê–î</button>
        </div>
        
        <!-- –≠–∫—Ä–∞–Ω –º–∞—Ç—á–∞ -->
        <div id="matchScreen" class="screen">
            <h2 id="matchTitle">–ú–ê–¢–ß</h2>
            
            <div class="hockey-rink">
                <div class="center-line"></div>
                <div class="team-name-rink left-team" id="leftTeamName">–ö–æ–º–∞–Ω–¥–∞ –ê</div>
                <div class="team-name-rink right-team" id="rightTeamName">–ö–æ–º–∞–Ω–¥–∞ –ë</div>
                <div class="score" id="leftScore">0</div>
                <div class="score" id="rightScore">0</div>
            </div>
            
            <div class="stats">
                <div class="stat-card">
                    <div id="playerTeamName">–í–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞</div>
                    <div>–°–ê: <span id="playerTeamSA">0</span></div>
                    <div>–°–ó: <span id="playerTeamSZ">0</span></div>
                </div>
                <div class="stat-card">
                    <div id="enemyTeamName">–°–æ–ø–µ—Ä–Ω–∏–∫</div>
                    <div>–°–ê: <span id="enemyTeamSA">0</span></div>
                    <div>–°–ó: <span id="enemyTeamSZ">0</span></div>
                </div>
            </div>
            
            <div class="match-log" id="matchLog">
                <!-- –õ–æ–≥ –º–∞—Ç—á–∞ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
            
            <button class="primary-btn" id="nextPeriodBtn" onclick="playNextPeriod()" style="display: none;">–°–õ–ï–î–£–Æ–©–ò–ô –ü–ï–†–ò–û–î</button>
            <button class="success-btn" id="playMatchBtn" onclick="startMatch()">–ù–ê–ß–ê–¢–¨ –ú–ê–¢–ß</button>
            <button class="primary-btn" id="continueBtn" onclick="continueAfterMatch()" style="display: none;">–ü–†–û–î–û–õ–ñ–ò–¢–¨</button>
        </div>

        <!-- –ü–ª–µ–π-–æ—Ñ—Ñ -->
        <div id="playoffScreen" class="screen">
            <h2>üèÜ –ü–õ–ï–ô-–û–§–§</h2>
            <div class="leaderboard">
                <h3>–¢–ê–ë–õ–ò–¶–ê –ü–õ–ï–ô-–û–§–§</h3>
                <div class="leaderboard-row leaderboard-header">
                    <div>#</div>
                    <div>–ö–û–ú–ê–ù–î–ê</div>
                    <div>–ò</div>
                    <div>–í</div>
                    <div>–û</div>
                </div>
                <div id="playoffLeaderboard">
                    <!-- –†–µ–π—Ç–∏–Ω–≥ –ø–ª–µ–π-–æ—Ñ—Ñ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
            
            <div class="daily-schedule">
                <h3>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è:</h3>
                <div id="playoffSchedule">
                    <!-- –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø–ª–µ–π-–æ—Ñ—Ñ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
            
            <button class="primary-btn" id="nextDayPlayoffBtn" onclick="nextDayPlayoff()">‚û°Ô∏è –°–õ–ï–î–£–Æ–©–ò–ô –î–ï–ù–¨</button>
        </div>

        <!-- –ü–æ–±–µ–¥–∏—Ç–µ–ª—å -->
        <div id="championScreen" class="screen">
            <div class="champion" id="championText">üéâ –ü–û–ë–ï–î–ò–¢–ï–õ–¨ –ö–£–ë–ö–ê –õ–û–•! üéâ</div>
            <div style="text-align: center;">
                <button class="primary-btn" onclick="startNewSeason()">‚û°Ô∏è –ù–û–í–´–ô –°–ï–ó–û–ù</button>
            </div>
        </div>

        <!-- –°–µ–∑–æ–Ω –∑–∞–≤–µ—Ä—à–µ–Ω (–Ω–µ –ø–æ–ø–∞–ª–∏ –≤ –ø–ª–µ–π-–æ—Ñ—Ñ) -->
        <div id="seasonEndScreen" class="screen">
            <h2>üèí –†–ï–ì–£–õ–Ø–†–ù–´–ô –°–ï–ó–û–ù –ó–ê–í–ï–†–®–ï–ù</h2>
            <div class="champion" id="seasonEndText">–í–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –ø—Ä–æ—à–ª–∞ –≤ –ø–ª–µ–π-–æ—Ñ—Ñ</div>
            <div style="text-align: center;">
                <button class="primary-btn" onclick="startNewSeason()">‚û°Ô∏è –ù–û–í–´–ô –°–ï–ó–û–ù</button>
            </div>
        </div>

        <div class="version">Build Version 0.1.5</div>
    </div>

    <script>
        // –ò–≥—Ä–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        const gameState = {
            teams: [],
            playerTeam: null,
            season: {
                year: 2023,
                stage: 'regular',
                matchesPlayed: {},
                totalRegularMatches: 15,
                calendar: {
                    currentDate: new Date(2023, 8, 1), // 1 —Å–µ–Ω—Ç—è–±—Ä—è 2023
                    matchDays: [],
                    currentWeek: 1
                }
            },
            playoff: {
                teams: [],
                series: {}, // –•—Ä–∞–Ω–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–µ—Ä–∏–π –º–µ–∂–¥—É –∫–æ–º–∞–Ω–¥–∞–º–∏
                matchesPlayed: {},
                calendar: {
                    currentDate: new Date(2024, 0, 1), // 1 —è–Ω–≤–∞—Ä—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –≥–æ–¥–∞
                    matchDays: [],
                    currentWeek: 1
                },
                champion: null
            },
            tournament: {
                currentOpponent: null
            },
            playerBudget: 0,
            matchState: {
                playerGoals: 0,
                enemyGoals: 0,
                currentPeriod: 0,
                isOvertime: false
            }
        };

        // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —ç–º–æ–¥–∑–∏ –¥–ª—è –∫–æ–º–∞–Ω–¥
        const teamEmojis = {
            "–ê–º—É—Ä –ë–ª–µ–π–∑–µ—Ä—Å": "ü¶Ö",
            "–ù–µ—Ñ—Ç—è–Ω—ã–µ –ö—Ä–æ–∫—Å—ã": "üêä", 
            "–ß–∫–∞–ª–æ–≤—Å–∫ –°–ø–µ–π—Å–º–µ–Ω": "üöÄ",
            "–ö–∏—Ä–ø–∞–∫ –°—Ç—Ä–∞–π–∫–µ—Ä—Å": "‚ö°",
            "–ü–æ—Ä—Ç-–ê—Ä—Ç—É—Ä –ê–¥–º–∏—Ä–∞–ª—Å": "‚öì",
            "–õ–µ–≤—ã–µ –ê–π–ª–µ–Ω–¥–µ—Ä—Å": "üèùÔ∏è"
        };

        // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —ç–º–æ–¥–∑–∏ –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤
        const specialPlayerEmojis = {
            "–ì—ç—Ä–∏ –ù—å—é—Ç–æ–Ω": "üòé",
            "–ê–ª–µ–∫—Å–µ–π –†—è–±–æ–≤": "üßî",
            "–≠–Ω–¥—Ä—é –ú–∞—Ä–∫–æ–≤": "ü§†",
            "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –°–∞—Ñ—Ä–æ–Ω–æ–≤": "üë®‚Äçü¶∞",
            "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –ñ–∞—Ä–∏–∫": "üë®‚Äçü¶±",
            "–ê–Ω—Ç–æ–Ω –ï—Ä—à–æ–≤": "üë®‚Äçüíº",
            "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –°–º–æ–ª–∏–Ω": "ü¶∏",
            "–ê–Ω—Ç–æ–Ω –°–∞–¥—á–∏–∫–æ–≤": "üßô",
            "–†–∏–¥ –ë—É—à–µ": "üë®‚ÄçüöÄ",
            "–ú–∞–π–∫–ª –ú–∞–∫–∫–ª–∞—É–¥": "üë®‚Äçüî¨",
            "–í–ª–∞–¥–∏–º–∏—Ä –¢–∫–∞—á—ë–≤": "üë®‚Äçüé§",
            "–ü–æ–ª—å –ü–æ–≥–±–∞": "üë®‚Äçüé®",
            "–î–∞–º–∏—Ä –®–∞—Ä–∏–ø–∑—è–Ω–æ–≤": "üë®‚Äçüç≥",
            "–ú–∞—Ä–∫–æ—à–∞ –ú–∞—Ä–∫–æ—à–∞": "üßõ",
            "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –†—è–±–æ–≤": "üßü"
        };

        // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —ç–º–æ–¥–∑–∏ –¥–ª—è —Ç—Ä–µ–Ω–µ—Ä–æ–≤
        const coachEmojis = {
            "–ò–≥–æ—Ä—å –°–µ—Ä–≥–µ–µ–≤–∏—á": "üë¥",
            "–°–µ—Ä–≥–µ–π –ú–∏—Ö–∞–π–ª–æ–≤–∏—á": "üßì",
            "–ì–∏ –ë—É—à–µ": "üë®‚Äçüè´",
            "–ú–∏—Ö–∞–∏–ª –ö—Ä–∞–≤–µ—Ü": "üßî‚Äç‚ôÇÔ∏è",
            "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –ñ–∞—Ä–∫–æ–≤": "üë®‚Äçüíª"
        };

        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —ç–º–æ–¥–∑–∏ –¥–ª—è —Å–ª—É—á–∞–π–Ω—ã—Ö –∏–≥—Ä–æ–∫–∏
        const randomPlayerEmojis = ["ü¶π", "üßù", "üßû", "üßú", "üë®‚Äçü¶≥", "üíÇ", "üë®‚Äç‚úàÔ∏è", "üë®‚Äçüîß", "üë®‚Äçüè≠", "üë®‚Äçüöí", "üë®‚Äçüåæ", "üë®‚Äç‚öïÔ∏è", "üë®‚Äç‚öñÔ∏è", "üë®‚Äç‚ù§Ô∏è"];

        // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∏–≥—Ä–æ–∫–∏ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ)
        const specialPlayers = [
            "–ì—ç—Ä–∏ –ù—å—é—Ç–æ–Ω", "–ê–ª–µ–∫—Å–µ–π –†—è–±–æ–≤", "–≠–Ω–¥—Ä—é –ú–∞—Ä–∫–æ–≤", "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –°–∞—Ñ—Ä–æ–Ω–æ–≤", 
            "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –ñ–∞—Ä–∏–∫", "–ê–Ω—Ç–æ–Ω –ï—Ä—à–æ–≤", "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –°–º–æ–ª–∏–Ω", "–ê–Ω—Ç–æ–Ω –°–∞–¥—á–∏–∫–æ–≤",
            "–†–∏–¥ –ë—É—à–µ", "–ú–∞–π–∫–ª –ú–∞–∫–∫–ª–∞—É–¥", "–í–ª–∞–¥–∏–º–∏—Ä –¢–∫–∞—á—ë–≤", "–ü–æ–ª—å –ü–æ–≥–±–∞",
            "–î–∞–º–∏—Ä –®–∞—Ä–∏–ø–∑—è–Ω–æ–≤", "–ú–∞—Ä–∫–æ—à–∞ –ú–∞—Ä–∫–æ—à–∞", "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –†—è–±–æ–≤"
        ];

        // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–Ω–µ—Ä—ã (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ)
        const specialCoaches = [
            "–ò–≥–æ—Ä—å –°–µ—Ä–≥–µ–µ–≤–∏—á", "–°–µ—Ä–≥–µ–π –ú–∏—Ö–∞–π–ª–æ–≤–∏—á", "–ì–∏ –ë—É—à–µ", 
            "–ú–∏—Ö–∞–∏–ª –ö—Ä–∞–≤–µ—Ü", "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –ñ–∞—Ä–∫–æ–≤"
        ];

        // –†—É—Å—Å–∫–∏–µ –∏–º–µ–Ω–∞ –∏ —Ñ–∞–º–∏–ª–∏–∏ (70%)
        const russianNames = ["–ê–ª–µ–∫—Å–∞–Ω–¥—Ä", "–ê–ª–µ–∫—Å–µ–π", "–î–º–∏—Ç—Ä–∏–π", "–°–µ—Ä–≥–µ–π", "–ê–Ω–¥—Ä–µ–π", "–ú–∏—Ö–∞–∏–ª", "–í–ª–∞–¥–∏–º–∏—Ä", "–ò–≤–∞–Ω", "–ï–≤–≥–µ–Ω–∏–π", "–ù–∏–∫–∏—Ç–∞"];
        const russianSurnames = ["–ò–≤–∞–Ω–æ–≤", "–ü–µ—Ç—Ä–æ–≤", "–°–∏–¥–æ—Ä–æ–≤", "–°–º–∏—Ä–Ω–æ–≤", "–ö—É–∑–Ω–µ—Ü–æ–≤", "–ü–æ–ø–æ–≤", "–í–∞—Å–∏–ª—å–µ–≤", "–°–æ–∫–æ–ª–æ–≤", "–ú–∏—Ö–∞–π–ª–æ–≤", "–§—ë–¥–æ—Ä–æ–≤"];

        // –ê–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∏–µ –∏–º–µ–Ω–∞ –Ω–∞ –∫–∏—Ä–∏–ª–ª–∏—Ü–µ (30%)
        const americanNames = ["–î–∂–µ–π–º—Å", "–î–∂–æ–Ω", "–†–æ–±–µ—Ä—Ç", "–ú–∞–π–∫–ª", "–£–∏–ª—å—è–º", "–î—ç–≤–∏–¥", "–†–∏—á–∞—Ä–¥", "–î–∂–æ–∑–µ—Ñ", "–¢–æ–º–∞—Å", "–ß–∞—Ä–ª—å–∑"];
        const americanSurnames = ["–°–º–∏—Ç", "–î–∂–æ–Ω—Å–æ–Ω", "–£–∏–ª—å—è–º—Å", "–ë—Ä–∞—É–Ω", "–î–∂–æ–Ω—Å", "–ú–∏–ª–µ—Ä", "–î—ç–≤–∏—Å", "–ì–∞—Ä—Å–∏—è", "–†–æ–¥—Ä–∏–≥–µ—Å", "–£–∏–ª—Å–æ–Ω"];

        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–≥—Ä–æ–∫–∏ –ù–•–õ/–ö–•–õ
        const additionalPlayers = [
            "–ê—Ä—Ç–µ–º–∏–π –ü–∞–Ω–∞—Ä–∏–Ω", "–ù–∏–∫–∏—Ç–∞ –ö—É—á–µ—Ä–æ–≤", "–ê–Ω–¥—Ä–µ–π –í–∞—Å–∏–ª–µ–≤—Å–∫–∏–π", "–ò–ª—å—è –°–æ—Ä–æ–∫–∏–Ω",
            "–ö–∏—Ä–∏–ª–ª –ö–∞–ø—Ä–∏–∑–æ–≤", "–ï–≥–æ—Ä –®–∞—Ä–∞–Ω–≥–æ–≤–∏—á", "–í–ª–∞–¥–∏–º–∏—Ä –¢–∞—Ä–∞—Å–µ–Ωko", "–ï–≤–≥–µ–Ω–∏–π –ö—É–∑–Ω–µ—Ü–æ–≤",
            "–í–∞–¥–∏–º –®–∏–ø–∞—á–µ–≤", "–°–µ—Ä–≥–µ–π –ú–æ–∑—è–∫–∏–Ω", "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –°–µ–º–∏–Ω", "–ò–ª—å—è –ö–æ–≤–∞–ª—å—á—É–∫",
            "–ü–∞–≤–µ–ª –î–∞—Ü—é–∫", "–°–µ—Ä–≥–µ–π –ë–æ–±—Ä–æ–≤—Å–∫–∏–π", "–ê–Ω–¥—Ä–µ–π –°–≤–µ—á–Ω–∏–∫–æ–≤", "–ö–∏—Ä–∏–ª–ª –ú–∞—Ä—á–µ–Ω–∫–æ"
        ];

        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–Ω–µ—Ä—ã
        const additionalCoaches = [
            "–ê–ª–µ–∫—Å–µ–π –ö—É–¥–∞—à–æ–≤", "–û–ª–µ–≥ –ó–Ω–∞—Ä–æ–∫", "–ò–ª—å—è –í–æ—Ä–æ–±—å–µ–≤", "–ë–æ–± –•–∞—Ä—Ç–ª–∏", 
            "–î—ç–π–≤ –ö–∏–Ω–≥", "–ó–∏–Ω—ç—Ç—É–ª–∞ –ë–∏–ª—è–ª–µ—Ç–¥–∏–Ω–æ–≤", "–í—è—á–µ—Å–ª–∞–≤ –ë—ã–∫–æ–≤"
        ];

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            createTeams();
            createPlayerPool();
            updateSeasonInfo();
            generateSeasonCalendar();
        }

        function updateSeasonInfo() {
            const stageText = gameState.season.stage === 'regular' ? '–†–µ–≥—É–ª—è—Ä–Ω—ã–π —Å–µ–∑–æ–Ω' : '–ü–ª–µ–π-–æ—Ñ—Ñ';
            document.getElementById('seasonInfo').textContent = `–°–µ–∑–æ–Ω: ${gameState.season.year} | –≠—Ç–∞–ø: ${stageText}`;
        }

        function updateCalendar() {
            const date = gameState.season.stage === 'regular' ? 
                gameState.season.calendar.currentDate : 
                gameState.playoff.calendar.currentDate;
                
            const day = date.getDate();
            const month = date.getMonth() + 1;
            const year = date.getFullYear();
            
            const monthNames = ["—è–Ω–≤–∞—Ä—è", "—Ñ–µ–≤—Ä–∞–ª—è", "–º–∞—Ä—Ç–∞", "–∞–ø—Ä–µ–ª—è", "–º–∞—è", "–∏—é–Ω—è", 
                              "–∏—é–ª—è", "–∞–≤–≥—É—Å—Ç–∞", "—Å–µ–Ω—Ç—è–±—Ä—è", "–æ–∫—Ç—è–±—Ä—è", "–Ω–æ—è–±—Ä—è", "–¥–µ–∫–∞–±—Ä—è"];
            
            const week = gameState.season.stage === 'regular' ? 
                gameState.season.calendar.currentWeek : 
                gameState.playoff.calendar.currentWeek;
            
            document.getElementById('calendarInfo').textContent = `${day} ${monthNames[month-1]} ${year} | –ù–µ–¥–µ–ª—è ${week}`;
        }

        function generateSeasonCalendar() {
            const matchDays = [];
            let currentDate = new Date(gameState.season.year, 8, 1); // 1 —Å–µ–Ω—Ç—è–±—Ä—è —Ç–µ–∫—É—â–µ–≥–æ –≥–æ–¥–∞
            let week = 1;
            
            // –°–æ–∑–¥–∞–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø–∞—Ä—ã –º–∞—Ç—á–µ–π (–∫–∞–∂–¥–∞—è –∫–æ–º–∞–Ω–¥–∞ –∏–≥—Ä–∞–µ—Ç —Å –∫–∞–∂–¥–æ–π 3 —Ä–∞–∑–∞)
            const allMatches = [];
            const teamCount = gameState.teams.length;
            
            for (let i = 0; i < teamCount; i++) {
                for (let j = i + 1; j < teamCount; j++) {
                    // –î–æ–±–∞–≤–ª—è–µ–º 3 –º–∞—Ç—á–∞ –º–µ–∂–¥—É –∫–∞–∂–¥–æ–π –ø–∞—Ä–æ–π –∫–æ–º–∞–Ω–¥
                    for (let k = 0; k < 3; k++) {
                        allMatches.push({ team1: i, team2: j });
                    }
                }
            }
            
            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –º–∞—Ç—á–∏
            for (let i = allMatches.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [allMatches[i], allMatches[j]] = [allMatches[j], allMatches[i]];
            }
            
            // –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –º–∞—Ç—á–∏ –ø–æ –Ω–µ–¥–µ–ª—è–º (–ø–æ –æ–¥–Ω–æ–º—É –º–∞—Ç—á—É –Ω–∞ –∫–æ–º–∞–Ω–¥—É –≤ –Ω–µ–¥–µ–ª—é)
            let matchIndex = 0;
            
            while (matchIndex < allMatches.length) {
                const matchesThisWeek = [];
                const teamsPlayedThisWeek = new Set();
                
                // –î–æ–±–∞–≤–ª—è–µ–º –º–∞—Ç—á–∏ –≤ –Ω–µ–¥–µ–ª—é, —Å–ª–µ–¥—è —á—Ç–æ–±—ã –∫–æ–º–∞–Ω–¥—ã –Ω–µ –∏–≥—Ä–∞–ª–∏ –±–æ–ª—å—à–µ –æ–¥–Ω–æ–≥–æ —Ä–∞–∑–∞
                while (matchIndex < allMatches.length && matchesThisWeek.length < 3) {
                    const match = allMatches[matchIndex];
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∏–≥—Ä–∞–ª–∏ –ª–∏ –∫–æ–º–∞–Ω–¥—ã —É–∂–µ –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ
                    if (!teamsPlayedThisWeek.has(match.team1) && !teamsPlayedThisWeek.has(match.team2)) {
                        matchesThisWeek.push(match);
                        teamsPlayedThisWeek.add(match.team1);
                        teamsPlayedThisWeek.add(match.team2);
                        matchIndex++;
                    } else {
                        // –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ —É–∂–µ –∏–≥—Ä–∞–ª–∞, –∏—â–µ–º —Å–ª–µ–¥—É—é—â–∏–π –ø–æ–¥—Ö–æ–¥—è—â–∏–π –º–∞—Ç—á
                        let found = false;
                        for (let i = matchIndex + 1; i < allMatches.length; i++) {
                            const nextMatch = allMatches[i];
                            if (!teamsPlayedThisWeek.has(nextMatch.team1) && !teamsPlayedThisWeek.has(nextMatch.team2)) {
                                // –ú–µ–Ω—è–µ–º –º–µ—Å—Ç–∞–º–∏ –º–∞—Ç—á–∏
                                [allMatches[matchIndex], allMatches[i]] = [allMatches[i], allMatches[matchIndex]];
                                found = true;
                                break;
                            }
                        }
                        if (!found) {
                            // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –º–∞—Ç—á, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º —ç—Ç—É –Ω–µ–¥–µ–ª—é
                            break;
                        }
                    }
                }
                
                // –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –º–∞—Ç—á–∏ –Ω–µ–¥–µ–ª–∏ –ø–æ –¥–Ω—è–º (—á–µ—Ä–µ–∑ –¥–µ–Ω—å)
                for (let i = 0; i < matchesThisWeek.length; i++) {
                    const matchDay = new Date(currentDate);
                    matchDay.setDate(currentDate.getDate() + (i * 2)); // –ú–∞—Ç—á–∏ —á–µ—Ä–µ–∑ –¥–µ–Ω—å
                    
                    matchDays.push({
                        date: new Date(matchDay),
                        matches: [matchesThisWeek[i]],
                        week: week
                    });
                }
                
                // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–π –Ω–µ–¥–µ–ª–µ (–ø–ª—é—Å 7 –¥–Ω–µ–π –æ—Ç –Ω–∞—á–∞–ª–∞ —Ç–µ–∫—É—â–µ–π –Ω–µ–¥–µ–ª–∏)
                currentDate.setDate(currentDate.getDate() + 7);
                week++;
                
                // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Å–µ–∑–æ–Ω 20 –Ω–µ–¥–µ–ª—è–º–∏
                if (week > 20) break;
            }
            
            gameState.season.calendar.matchDays = matchDays;
            gameState.season.calendar.currentWeek = 1;
        }

        function generatePlayoffCalendar() {
            const matchDays = [];
            let currentDate = new Date(gameState.season.year + 1, 0, 1); // 1 —è–Ω–≤–∞—Ä—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –≥–æ–¥–∞
            let week = 1;
            
            // –°–æ–∑–¥–∞–µ–º –º–∞—Ç—á–∏ –ø–ª–µ–π-–æ—Ñ—Ñ (–∫–∞–∂–¥–∞—è –∫–æ–º–∞–Ω–¥–∞ –∏–≥—Ä–∞–µ—Ç —Å –∫–∞–∂–¥–æ–π)
            const allMatches = [];
            const playoffTeams = gameState.playoff.teams;
            
            for (let i = 0; i < playoffTeams.length; i++) {
                for (let j = i + 1; j < playoffTeams.length; j++) {
                    allMatches.push({ 
                        team1: playoffTeams[i].index, 
                        team2: playoffTeams[j].index 
                    });
                }
            }
            
            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –º–∞—Ç—á–∏
            for (let i = allMatches.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [allMatches[i], allMatches[j]] = [allMatches[j], allMatches[i]];
            }
            
            // –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –º–∞—Ç—á–∏ –ø–æ –Ω–µ–¥–µ–ª—è–º (–ø–æ –æ–¥–Ω–æ–º—É –º–∞—Ç—á—É –Ω–∞ –∫–æ–º–∞–Ω–¥—É –≤ –Ω–µ–¥–µ–ª—é)
            let matchIndex = 0;
            
            while (true) {
                const matchesThisWeek = [];
                const teamsPlayedThisWeek = new Set();
                
                // –î–æ–±–∞–≤–ª—è–µ–º –º–∞—Ç—á–∏ –≤ –Ω–µ–¥–µ–ª—é, —Å–ª–µ–¥—è —á—Ç–æ–±—ã –∫–æ–º–∞–Ω–¥—ã –Ω–µ –∏–≥—Ä–∞–ª–∏ –±–æ–ª—å—à–µ –æ–¥–Ω–æ–≥–æ —Ä–∞–∑–∞
                while (matchIndex < allMatches.length && matchesThisWeek.length < 2) {
                    const match = allMatches[matchIndex];
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∏–≥—Ä–∞–ª–∏ –ª–∏ –∫–æ–º–∞–Ω–¥—ã —É–∂–µ –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ
                    if (!teamsPlayedThisWeek.has(match.team1) && !teamsPlayedThisWeek.has(match.team2)) {
                        matchesThisWeek.push(match);
                        teamsPlayedThisWeek.add(match.team1);
                        teamsPlayedThisWeek.add(match.team2);
                        matchIndex++;
                    } else {
                        // –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ —É–∂–µ –∏–≥—Ä–∞–ª–∞, –∏—â–µ–º —Å–ª–µ–¥—É—é—â–∏–π –ø–æ–¥—Ö–æ–¥—è—â–∏–π –º–∞—Ç—á
                        let found = false;
                        for (let i = matchIndex + 1; i < allMatches.length; i++) {
                            const nextMatch = allMatches[i];
                            if (!teamsPlayedThisWeek.has(nextMatch.team1) && !teamsPlayedThisWeek.has(nextMatch.team2)) {
                                [allMatches[matchIndex], allMatches[i]] = [allMatches[i], allMatches[matchIndex]];
                                found = true;
                                break;
                            }
                        }
                        if (!found) break;
                    }
                }
                
                // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –º–∞—Ç—á–µ–π –¥–ª—è —ç—Ç–æ–π –Ω–µ–¥–µ–ª–∏, –Ω–∞—á–∏–Ω–∞–µ–º –∑–∞–Ω–æ–≤–æ
                if (matchesThisWeek.length === 0) {
                    matchIndex = 0;
                    continue;
                }
                
                // –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –º–∞—Ç—á–∏ –Ω–µ–¥–µ–ª–∏ –ø–æ –¥–Ω—è–º (—á–µ—Ä–µ–∑ –¥–µ–Ω—å)
                for (let i = 0; i < matchesThisWeek.length; i++) {
                    const matchDay = new Date(currentDate);
                    matchDay.setDate(currentDate.getDate() + (i * 2));
                    
                    matchDays.push({
                        date: new Date(matchDay),
                        matches: [matchesThisWeek[i]],
                        week: week
                    });
                }
                
                // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–π –Ω–µ–¥–µ–ª–µ
                currentDate.setDate(currentDate.getDate() + 7);
                week++;
                
                // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –ø–ª–µ–π-–æ—Ñ—Ñ 20 –Ω–µ–¥–µ–ª—è–º–∏
                if (week > 20) break;
            }
            
            gameState.playoff.calendar.matchDays = matchDays;
            gameState.playoff.calendar.currentWeek = 1;
        }

        function getTodaysMatches() {
            const currentDate = gameState.season.stage === 'regular' ? 
                gameState.season.calendar.currentDate : 
                gameState.playoff.calendar.currentDate;
                
            const matchDays = gameState.season.stage === 'regular' ? 
                gameState.season.calendar.matchDays : 
                gameState.playoff.calendar.matchDays;
                
            const matchDay = matchDays.find(day => 
                day.date.getDate() === currentDate.getDate() && 
                day.date.getMonth() === currentDate.getMonth() &&
                day.date.getFullYear() === currentDate.getFullYear()
            );
            return matchDay ? matchDay.matches : [];
        }

        function createTeams() {
            const teamsData = [
                { name: "–ê–º—É—Ä –ë–ª–µ–π–∑–µ—Ä—Å" },
                { name: "–ù–µ—Ñ—Ç—è–Ω—ã–µ –ö—Ä–æ–∫—Å—ã" },
                { name: "–ß–∫–∞–ª–æ–≤—Å–∫ –°–ø–µ–π—Å–º–µ–Ω" },
                { name: "–ö–∏—Ä–ø–∞–∫ –°—Ç—Ä–∞–π–∫–µ—Ä—Å" },
                { name: "–ü–æ—Ä—Ç-–ê—Ä—Ç—É—Ä –ê–¥–º–∏—Ä–∞–ª—Å" },
                { name: "–õ–µ–≤—ã–µ –ê–π–ª–µ–Ω–¥–µ—Ä—Å" }
            ];

            teamsData.forEach((teamData, index) => {
                const players = [];
                // 5 –ø–æ–ª–µ–≤—ã—Ö –∏–≥—Ä–æ–∫–æ–≤
                for (let i = 0; i < 5; i++) {
                    players.push(createPlayer(false));
                }
                // 1 –≤—Ä–∞—Ç–∞—Ä—å
                players.push(createPlayer(true));
                
                const coach = createCoach();
                
                const teamName = teamData.name;
                const emoji = teamEmojis[teamName];
                
                gameState.teams.push({
                    name: teamName,
                    emoji: emoji,
                    players: players,
                    coach: coach,
                    points: 0,
                    wins: 0,
                    losses: 0,
                    games: 0
                });
                
                gameState.season.matchesPlayed[index] = 0;
            });

            const teamSelectGrid = document.getElementById('teamSelectGrid');
            gameState.teams.forEach((team, index) => {
                const teamCard = document.createElement('div');
                teamCard.className = 'team-card';
                teamCard.innerHTML = `
                    <div class="team-emoji">${team.emoji}</div>
                    <div>${team.name}</div>
                `;
                teamCard.onclick = () => selectTeam(index);
                teamSelectGrid.appendChild(teamCard);
            });
        }

        function calculatePlayerCost(player) {
            if (player.isGoalie) {
                // –í—Ä–∞—Ç–∞—Ä–∏
                if (player.SZ >= 1 && player.SZ <= 6) {
                    return 6000000;
                } else if (player.SZ >= 7 && player.SZ <= 10) {
                    return 12500000;
                }
            } else {
                // –ü–æ–ª–µ–≤—ã–µ –∏–≥—Ä–æ–∫–∏
                const totalStats = player.SA + player.SZ;
                if (totalStats >= 1 && totalStats <= 9) {
                    return 4500000;
                } else if (totalStats >= 10 && totalStats <= 13) {
                    return 7500000;
                } else if (totalStats >= 14 && totalStats <= 20) {
                    return 10000000;
                }
            }
            return 5000000; // fallback
        }

        function createPlayer(isGoalie) {
            let name;
            
            if (specialPlayers.length > 0 && Math.random() < 0.3) {
                name = specialPlayers.shift();
            } else {
                const isRussian = Math.random() < 0.7;
                
                if (isRussian) {
                    if (additionalPlayers.length > 0 && Math.random() < 0.5) {
                        name = additionalPlayers[Math.floor(Math.random() * additionalPlayers.length)];
                    } else {
                        const firstName = russianNames[Math.floor(Math.random() * russianNames.length)];
                        const lastName = russianSurnames[Math.floor(Math.random() * russianSurnames.length)];
                        name = `${firstName} ${lastName}`;
                    }
                } else {
                    const firstName = americanNames[Math.floor(Math.random() * americanNames.length)];
                    const lastName = americanSurnames[Math.floor(Math.random() * americanSurnames.length)];
                    name = `${firstName} ${lastName}`;
                }
            }
            
            let baseSA, baseSZ;
            if (name.includes("–ù—å—é—Ç–æ–Ω") || name.includes("–†—è–±–æ–≤") || name.includes("–ú–∞—Ä–∫–æ–≤") || 
                name.includes("–°–∞—Ñ—Ä–æ–Ω–æ–≤") || name.includes("–ñ–∞—Ä–∏–∫") || name.includes("–°–º–æ–ª–∏–Ω")) {
                baseSA = isGoalie ? 0 : Math.floor(Math.random() * 3) + 6;
                baseSZ = isGoalie ? Math.floor(Math.random() * 3) + 6 : Math.floor(Math.random() * 3) + 6;
            } else {
                baseSA = isGoalie ? 0 : Math.floor(Math.random() * 6) + 3;
                baseSZ = isGoalie ? Math.floor(Math.random() * 6) + 4 : Math.floor(Math.random() * 6) + 3;
            }

            const cost = calculatePlayerCost({ isGoalie, SA: baseSA, SZ: baseSZ });

            const emoji = specialPlayerEmojis[name] || randomPlayerEmojis[Math.floor(Math.random() * randomPlayerEmojis.length)];

            return {
                name: name,
                emoji: emoji,
                SA: baseSA,
                SZ: baseSZ,
                cost: cost,
                number: Math.floor(Math.random() * 99) + 1,
                isGoalie: isGoalie
            };
        }

        function createCoach() {
            let name;
            
            if (specialCoaches.length > 0 && Math.random() < 0.4) {
                name = specialCoaches.shift();
            } else if (additionalCoaches.length > 0) {
                name = additionalCoaches[Math.floor(Math.random() * additionalCoaches.length)];
            } else {
                const isRussian = Math.random() < 0.7;
                const names = isRussian ? russianNames : americanNames;
                const surnames = isRussian ? russianSurnames : americanSurnames;
                name = `${names[Math.floor(Math.random() * names.length)]} ${surnames[Math.floor(Math.random() * surnames.length)]}`;
            }

            let ST;
            if (name.includes("–°–µ—Ä–≥–µ–µ–≤–∏—á") || name.includes("–ú–∏—Ö–∞–π–ª–æ–≤–∏—á") || name.includes("–ë—É—à–µ") || 
                name.includes("–ö—Ä–∞–≤–µ—Ü") || name.includes("–ñ–∞—Ä–∫–æ–≤")) {
                ST = Math.max(1.2, (Math.floor(Math.random() * 8) + 12) / 10);
            } else {
                ST = Math.max(1.0, (Math.floor(Math.random() * 10) + 10) / 10);
            }

            const emoji = coachEmojis[name] || "üë®‚Äçüíº";

            return {
                name: name,
                emoji: emoji,
                ST: ST
            };
        }

        function createPlayerPool() {
            gameState.freeAgents = [];
            for (let i = 0; i < 20; i++) {
                gameState.freeAgents.push(createPlayer(false));
            }
            for (let i = 0; i < 5; i++) {
                gameState.freeAgents.push(createPlayer(true));
            }
        }

        function selectTeam(teamIndex) {
            gameState.playerTeam = teamIndex;
            gameState.playerBudget = 0;
            gameState.season.matchesPlayed = {};
            gameState.teams.forEach((team, index) => {
                gameState.season.matchesPlayed[index] = 0;
            });
            gameState.tournament.matches = [];
            gameState.season.calendar.currentDate = new Date(2023, 8, 1);
            gameState.season.calendar.currentWeek = 1;
            
            showScreen('teamManagement');
            updateTeamManagement();
            updateCalendar();
            updateDailySchedule();
            updateMainScreenLeaderboard();
        }

        function updateTeamManagement() {
            const team = gameState.teams[gameState.playerTeam];
            
            document.getElementById('currentTeamName').textContent = `${team.emoji} ${team.name}`;
            document.getElementById('budgetValue').textContent = gameState.playerBudget.toLocaleString();
            document.getElementById('coachName').textContent = team.coach.name;
            document.getElementById('coachEmoji').textContent = team.coach.emoji;
            document.getElementById('coachSkill').textContent = team.coach.ST;
            
            const teamStats = calculateTeamStats(team);
            document.getElementById('teamSA').textContent = teamStats.SA.toFixed(1);
            document.getElementById('teamSZ').textContent = teamStats.SZ.toFixed(1);
            
            const playerList = document.getElementById('playerList');
            playerList.innerHTML = '';
            
            team.players.forEach((player, index) => {
                const playerCard = document.createElement('div');
                playerCard.className = 'player-card';
                playerCard.innerHTML = `
                    <div><span class="player-emoji">${player.emoji}</span> #${player.number} ${player.name}</div>
                    <div>${player.isGoalie ? '–°–ó–í: ' + player.SZ : '–°–ê: ' + player.SA + ' –°–ó: ' + player.SZ}</div>
                    <div>üíµ ${player.cost.toLocaleString()} –†–£–ë</div>
                `;
                playerList.appendChild(playerCard);
            });
            
            const todaysMatches = getTodaysMatches();
            const playerTeamIndex = gameState.playerTeam;
            let hasMatch = false;
            
            todaysMatches.forEach(match => {
                if (match.team1 === playerTeamIndex || match.team2 === playerTeamIndex) {
                    hasMatch = true;
                }
            });
            
            document.getElementById('nextDayBtn').style.display = hasMatch ? 'none' : 'block';
        }

        function updateMainScreenLeaderboard() {
            const leaderboardContainer = document.getElementById('mainScreenLeaderboard');
            leaderboardContainer.innerHTML = '';
            
            const sortedTeams = [...gameState.teams].sort((a, b) => b.points - a.points);
            
            sortedTeams.forEach((team, index) => {
                const row = document.createElement('div');
                row.className = 'leaderboard-row';
                row.innerHTML = `
                    <div>${index + 1}</div>
                    <div>${team.emoji} ${team.name}</div>
                    <div>${team.games}</div>
                    <div>${team.wins}</div>
                    <div>${team.points}</div>
                `;
                leaderboardContainer.appendChild(row);
            });
        }

        function updateDailySchedule() {
            const schedule = document.getElementById('dailySchedule');
            schedule.innerHTML = '';
            
            const todaysMatches = getTodaysMatches();
            const playerTeamIndex = gameState.playerTeam;
            let playerMatch = null;
            
            todaysMatches.forEach(match => {
                const team1 = gameState.teams[match.team1];
                const team2 = gameState.teams[match.team2];
                
                if (match.team1 === playerTeamIndex || match.team2 === playerTeamIndex) {
                    playerMatch = match;
                }
                
                const matchElement = document.createElement('div');
                matchElement.className = 'schedule-item';
                matchElement.innerHTML = `${team1.emoji} ${team1.name} vs ${team2.emoji} ${team2.name}`;
                schedule.appendChild(matchElement);
            });
            
            if (todaysMatches.length === 0) {
                schedule.innerHTML = '<div class="schedule-item">–°–µ–≥–æ–¥–Ω—è –º–∞—Ç—á–µ–π –Ω–µ—Ç</div>';
            }
            
            if (playerMatch) {
                const playButton = document.createElement('button');
                playButton.className = 'success-btn';
                playButton.textContent = '–ò–ì–†–ê–¢–¨ –ú–ê–¢–ß';
                playButton.onclick = () => {
                    const opponentIndex = playerMatch.team1 === playerTeamIndex ? playerMatch.team2 : playerMatch.team1;
                    gameState.tournament.currentOpponent = opponentIndex;
                    setupMatchScreen(opponentIndex);
                };
                schedule.appendChild(playButton);
            }
        }

        function updatePlayoffSchedule() {
            const schedule = document.getElementById('playoffSchedule');
            schedule.innerHTML = '';
            
            const todaysMatches = getTodaysMatches();
            const playerTeamIndex = gameState.playerTeam;
            let playerMatch = null;
            
            todaysMatches.forEach(match => {
                const team1 = gameState.teams[match.team1];
                const team2 = gameState.teams[match.team2];
                
                if (match.team1 === playerTeamIndex || match.team2 === playerTeamIndex) {
                    playerMatch = match;
                }
                
                const matchElement = document.createElement('div');
                matchElement.className = 'schedule-item';
                matchElement.innerHTML = `${team1.emoji} ${team1.name} vs ${team2.emoji} ${team2.name}`;
                schedule.appendChild(matchElement);
            });
            
            if (todaysMatches.length === 0) {
                schedule.innerHTML = '<div class="schedule-item">–°–µ–≥–æ–¥–Ω—è –º–∞—Ç—á–µ–π –Ω–µ—Ç</div>';
            }
            
            if (playerMatch) {
                const playButton = document.createElement('button');
                playButton.className = 'success-btn';
                playButton.textContent = '–ò–ì–†–ê–¢–¨ –ú–ê–¢–ß';
                playButton.onclick = () => {
                    const opponentIndex = playerMatch.team1 === playerTeamIndex ? playerMatch.team2 : playerMatch.team1;
                    gameState.tournament.currentOpponent = opponentIndex;
                    setupMatchScreen(opponentIndex);
                };
                schedule.appendChild(playButton);
            }
        }

        function updatePlayoffLeaderboard() {
            const leaderboardContainer = document.getElementById('playoffLeaderboard');
            leaderboardContainer.innerHTML = '';
            
            const sortedTeams = [...gameState.playoff.teams].sort((a, b) => b.points - a.points);
            
            sortedTeams.forEach((teamData, index) => {
                const team = gameState.teams[teamData.index];
                const row = document.createElement('div');
                row.className = 'leaderboard-row';
                row.innerHTML = `
                    <div>${index + 1}</div>
                    <div>${team.emoji} ${team.name}</div>
                    <div>${team.games}</div>
                    <div>${team.wins}</div>
                    <div>${team.points}</div>
                `;
                leaderboardContainer.appendChild(row);
            });
        }

        function calculateTeamStats(team) {
            let totalSA = 0;
            let totalSZ = 0;
            
            team.players.forEach(player => {
                if (player.isGoalie) {
                    totalSZ += player.SZ;
                } else {
                    totalSA += player.SA;
                    totalSZ += player.SZ;
                }
            });
            
            return {
                SA: totalSA * team.coach.ST,
                SZ: totalSZ * team.coach.ST
            };
        }

        function startTournament() {
            showScreen('teamSelect');
        }

        function nextDay() {
            const currentDate = gameState.season.calendar.currentDate;
            currentDate.setDate(currentDate.getDate() + 1);
            
            const currentMatchDay = gameState.season.calendar.matchDays.find(day => 
                day.date.getDate() === currentDate.getDate() && 
                day.date.getMonth() === currentDate.getMonth() &&
                day.date.getFullYear() === currentDate.getFullYear()
            );
            
            if (currentMatchDay) {
                gameState.season.calendar.currentWeek = currentMatchDay.week;
            }
            
            simulateTodaysMatches();
            
            updateCalendar();
            updateDailySchedule();
            updateTeamManagement();
            updateMainScreenLeaderboard();
            
            checkRegularSeasonEnd();
        }

        function nextDayPlayoff() {
            const currentDate = gameState.playoff.calendar.currentDate;
            currentDate.setDate(currentDate.getDate() + 1);
            
            const currentMatchDay = gameState.playoff.calendar.matchDays.find(day => 
                day.date.getDate() === currentDate.getDate() && 
                day.date.getMonth() === currentDate.getMonth() &&
                day.date.getFullYear() === currentDate.getFullYear()
            );
            
            if (currentMatchDay) {
                gameState.playoff.calendar.currentWeek = currentMatchDay.week;
            }
            
            simulateTodaysMatches();
            
            updateCalendar();
            updatePlayoffSchedule();
            updatePlayoffLeaderboard();
            
            checkPlayoffEnd();
        }

        function simulateTodaysMatches() {
            const todaysMatches = getTodaysMatches();
            const playerTeamIndex = gameState.playerTeam;
            
            todaysMatches.forEach(match => {
                if (match.team1 !== playerTeamIndex && match.team2 !== playerTeamIndex) {
                    simulateAIMatch(match.team1, match.team2);
                }
            });
        }

        function simulateAIMatch(team1Index, team2Index) {
            const team1 = gameState.teams[team1Index];
            const team2 = gameState.teams[team2Index];
            
            const team1Stats = calculateTeamStats(team1);
            const team2Stats = calculateTeamStats(team2);
            
            let team1Goals = 0;
            let team2Goals = 0;
            
            for (let period = 0; period < 3; period++) {
                for (let i = 0; i < 3; i++) {
                    if (Math.random() * 100 < team1Stats.SA && Math.random() * 100 >= team2Stats.SZ) {
                        team1Goals++;
                    }
                    if (Math.random() * 100 < team2Stats.SA && Math.random() * 100 >= team1Stats.SZ) {
                        team2Goals++;
                    }
                }
            }
            
            if (team1Goals > team2Goals) {
                team1.wins++;
                team1.points += 2;
                team2.losses++;
            } else if (team2Goals > team1Goals) {
                team2.wins++;
                team2.points += 2;
                team1.losses++;
            } else {
                if (Math.random() < 0.5) {
                    team1Goals++;
                    team1.wins++;
                    team1.points += 2;
                    team2.points += 1;
                    team2.losses++;
                } else {
                    team2Goals++;
                    team2.wins++;
                    team2.points += 2;
                    team1.points += 1;
                    team1.losses++;
                }
            }
            
            team1.games++;
            team2.games++;
            
            if (gameState.season.stage === 'regular') {
                gameState.season.matchesPlayed[team1Index]++;
                gameState.season.matchesPlayed[team2Index]++;
            }
        }

        function setupMatchScreen(opponentIndex) {
            const playerTeam = gameState.teams[gameState.playerTeam];
            const enemyTeam = gameState.teams[opponentIndex];
            
            const playerStats = calculateTeamStats(playerTeam);
            const enemyStats = calculateTeamStats(enemyTeam);
            
            document.getElementById('playerTeamName').textContent = playerTeam.name;
            document.getElementById('playerTeamSA').textContent = playerStats.SA.toFixed(1);
            document.getElementById('playerTeamSZ').textContent = playerStats.SZ.toFixed(1);
            
            document.getElementById('enemyTeamName').textContent = enemyTeam.name;
            document.getElementById('enemyTeamSA').textContent = enemyStats.SA.toFixed(1);
            document.getElementById('enemyTeamSZ').textContent = enemyStats.SZ.toFixed(1);
            
            document.getElementById('leftTeamName').textContent = playerTeam.name;
            document.getElementById('rightTeamName').textContent = enemyTeam.name;
            document.getElementById('leftScore').textContent = '0';
            document.getElementById('rightScore').textContent = '0';
            
            document.getElementById('matchTitle').textContent = `${playerTeam.emoji} ${playerTeam.name} vs ${enemyTeam.emoji} ${enemyTeam.name}`;
            document.getElementById('matchLog').innerHTML = '–ú–∞—Ç—á –≥–æ—Ç–æ–≤ –∫ –Ω–∞—á–∞–ª—É!';
            
            gameState.matchState = {
                playerGoals: 0,
                enemyGoals: 0,
                currentPeriod: 0,
                isOvertime: false
            };
            
            document.getElementById('playMatchBtn').style.display = 'block';
            document.getElementById('nextPeriodBtn').style.display = 'none';
            document.getElementById('continueBtn').style.display = 'none';
            
            showScreen('matchScreen');
        }

        function startMatch() {
            document.getElementById('playMatchBtn').style.display = 'none';
            document.getElementById('nextPeriodBtn').style.display = 'block';
            playNextPeriod();
        }

        function playNextPeriod() {
            const playerTeam = gameState.teams[gameState.playerTeam];
            const enemyTeam = gameState.teams[gameState.tournament.currentOpponent];
            
            const playerStats = calculateTeamStats(playerTeam);
            const enemyStats = calculateTeamStats(enemyTeam);
            
            const matchLog = document.getElementById('matchLog');
            
            gameState.matchState.currentPeriod++;
            
            if (gameState.matchState.currentPeriod > 3) {
                gameState.matchState.isOvertime = true;
                addToMatchLog(`<div class="overtime">=== –û–í–ï–†–¢–ê–ô–ú ===</div>`);
                
                if (Math.random() < 0.5) {
                    gameState.matchState.playerGoals++;
                    addToMatchLog(`<div class="goal">üéØ ${playerTeam.name} –ó–ê–ë–ò–í–ê–Æ–¢ –í –û–í–ï–†–¢–ê–ô–ú–ï!</div>`);
                } else {
                    gameState.matchState.enemyGoals++;
                    addToMatchLog(`<div class="goal">üéØ ${enemyTeam.name} –ó–ê–ë–ò–í–ê–Æ–¢ –í –û–í–ï–†–¢–ê–ô–ú–ï!</div>`);
                }
                
                endMatch();
                return;
            }
            
            addToMatchLog(`<div class="period">=== ${gameState.matchState.currentPeriod}-–ô –ü–ï–†–ò–û–î ===</div>`);
            
            let periodPlayerGoals = 0;
            let periodEnemyGoals = 0;
            
            for (let i = 0; i < 3; i++) {
                addToMatchLog(`<div class="attack">${playerTeam.name} –∞—Ç–∞–∫—É—é—Ç...</div>`);
                if (Math.random() * 100 < playerStats.SA) {
                    if (Math.random() * 100 >= enemyStats.SZ) {
                        periodPlayerGoals++;
                        addToMatchLog(`<div class="goal">‚ö° –ì–û–õ! ${playerTeam.name} –∑–∞–±–∏–≤–∞—é—Ç!</div>`);
                    } else {
                        addToMatchLog(`<div class="save">ü•Ö ${enemyTeam.name} –æ—Ç—Ä–∞–∂–∞—é—Ç –±—Ä–æ—Å–æ–∫!</div>`);
                    }
                } else {
                    addToMatchLog(`<div class="save">‚ùå ${playerTeam.name} –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ —Å—Ç–≤–æ—Ä!</div>`);
                }
            }
            
            for (let i = 0; i < 3; i++) {
                addToMatchLog(`<div class="attack">${enemyTeam.name} –∞—Ç–∞–∫—É—é—Ç...</div>`);
                if (Math.random() * 100 < enemyStats.SA) {
                    if (Math.random() * 100 >= playerStats.SZ) {
                        periodEnemyGoals++;
                        addToMatchLog(`<div class="goal">‚ö° –ì–û–õ! ${enemyTeam.name} –∑–∞–±–∏–≤–∞—é—Ç!</div>`);
                    } else {
                        addToMatchLog(`<div class="save">ü•Ö ${playerTeam.name} –æ—Ç—Ä–∞–∂–∞—é—Ç –±—Ä–æ—Å–æ–∫!</div>`);
                    }
                } else {
                    addToMatchLog(`<div class="save">‚ùå ${enemyTeam.name} –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ —Å—Ç–≤–æ—Ä!</div>`);
                }
            }
            
            gameState.matchState.playerGoals += periodPlayerGoals;
            gameState.matchState.enemyGoals += periodEnemyGoals;
            
            document.getElementById('leftScore').textContent = gameState.matchState.playerGoals;
            document.getElementById('rightScore').textContent = gameState.matchState.enemyGoals;
            
            addToMatchLog(`<div>–ò—Ç–æ–≥ –ø–µ—Ä–∏–æ–¥–∞: ${periodPlayerGoals}-${periodEnemyGoals}</div>`);
            
            if (gameState.matchState.currentPeriod === 3) {
                if (gameState.matchState.playerGoals === gameState.matchState.enemyGoals) {
                    addToMatchLog(`<div>–ù–∏—á—å—è! –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –æ–≤–µ—Ä—Ç–∞–π–º</div>`);
                    document.getElementById('nextPeriodBtn').textContent = '–û–í–ï–†–¢–ê–ô–ú';
                } else {
                    endMatch();
                }
            }
        }

        function endMatch() {
            const playerTeam = gameState.teams[gameState.playerTeam];
            const enemyTeam = gameState.teams[gameState.tournament.currentOpponent];
            
            document.getElementById('nextPeriodBtn').style.display = 'none';
            document.getElementById('continueBtn').style.display = 'block';
            
            if (gameState.matchState.playerGoals > gameState.matchState.enemyGoals) {
                const reward = gameState.matchState.playerGoals * 1000000;
                gameState.playerBudget += reward;
                addToMatchLog(`<div class="money">üí∞ –ü–û–ë–ï–î–ê! +${reward.toLocaleString()} –†–£–ë</div>`);
                
                playerTeam.wins++;
                playerTeam.points += 2;
                enemyTeam.losses++;
            } else {
                const reward = gameState.matchState.playerGoals * 150000;
                gameState.playerBudget += reward;
                addToMatchLog(`<div class="money">üí∏ –ü–æ—Ä–∞–∂–µ–Ω–∏–µ... +${reward.toLocaleString()} –†–£–ë</div>`);
                
                playerTeam.losses++;
                if (gameState.matchState.isOvertime) {
                    playerTeam.points += 1;
                    enemyTeam.points += 2;
                } else {
                    enemyTeam.points += 2;
                }
                enemyTeam.wins++;
            }
            
            playerTeam.games++;
            enemyTeam.games++;
            
            if (gameState.season.stage === 'regular') {
                gameState.season.matchesPlayed[gameState.playerTeam]++;
                gameState.season.matchesPlayed[gameState.tournament.currentOpponent]++;
            }
            
            if (Math.random() < 0.05) {
                const sponsorBonus = Math.floor(Math.random() * (10000000 - 25000) / 25000 + 1) * 25000;
                gameState.playerBudget += sponsorBonus;
                addToMatchLog(`<div class="money">üéÅ –ü–û–î–î–ï–†–ñ–ö–ê –°–ü–û–ù–°–û–†–ê! +${sponsorBonus.toLocaleString()} –†–£–ë</div>`);
            }
        }

        function continueAfterMatch() {
            if (gameState.season.stage === 'regular') {
                showScreen('teamManagement');
                updateTeamManagement();
                updateMainScreenLeaderboard();
                nextDay();
            } else {
                showScreen('playoffScreen');
                updatePlayoffLeaderboard();
                updatePlayoffSchedule();
                nextDayPlayoff();
            }
        }

        function checkRegularSeasonEnd() {
            // –ö–æ—Å—Ç—ã–ª—å: –µ—Å–ª–∏ –Ω–∞—Å—Ç—É–ø–∏–ª–∞ 16 –Ω–µ–¥–µ–ª—è –∏ —Ö–æ—Ç—è –±—ã 3 –∫–æ–º–∞–Ω–¥—ã —Å—ã–≥—Ä–∞–ª–∏ 15+ –∏–≥—Ä
            if (gameState.season.calendar.currentWeek >= 16) {
                const teamsWith15Games = Object.values(gameState.season.matchesPlayed).filter(games => games >= 15).length;
                if (teamsWith15Games >= 3) {
                    endRegularSeason();
                    return;
                }
            }
            
            // –û–±—ã—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –≤—Å–µ –ª–∏ –∫–æ–º–∞–Ω–¥—ã —Å—ã–≥—Ä–∞–ª–∏ –ø–æ 15 –º–∞—Ç—á–µ–π
            const allTeamsPlayed15 = Object.values(gameState.season.matchesPlayed).every(games => games >= 15);
            
            if (allTeamsPlayed15) {
                endRegularSeason();
            }
        }

        function endRegularSeason() {
            const sortedTeams = [...gameState.teams].sort((a, b) => b.points - a.points);
            const playerTeamIndex = gameState.playerTeam;
            const playerTeam = gameState.teams[playerTeamIndex];
            
            const playerPosition = sortedTeams.findIndex(team => team.name === playerTeam.name);
            
            if (playerPosition < 4) {
                startPlayoff();
            } else {
                showSeasonEndScreen();
            }
        }

        function startPlayoff() {
            gameState.season.stage = 'playoff';
            updateSeasonInfo();
            
            // –°–ë–†–ê–°–´–í–ê–ï–ú –°–¢–ê–¢–ò–°–¢–ò–ö–£ –ö–û–ú–ê–ù–î –î–õ–Ø –ü–õ–ï–ô-–û–§–§
            gameState.teams.forEach(team => {
                team.points = 0;
                team.wins = 0;
                team.losses = 0;
                team.games = 0;
            });
            
            // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ò–†–£–ï–ú –°–ï–†–ò–ò –ü–õ–ï–ô-–û–§–§
            gameState.playoff.series = {};
            const playoffTeams = [...gameState.teams].sort((a, b) => b.points - a.points).slice(0, 4);
            
            // –°–æ–∑–¥–∞–µ–º –ø–∞—Ä—ã –¥–ª—è –ø–ª–µ–π-–æ—Ñ—Ñ: 1 vs 4, 2 vs 3
            const playoffPairs = [
                { team1: playoffTeams[0], team2: playoffTeams[3] },
                { team1: playoffTeams[1], team2: playoffTeams[2] }
            ];
            
            playoffPairs.forEach(pair => {
                const key1 = `${pair.team1.name}-${pair.team2.name}`;
                const key2 = `${pair.team2.name}-${pair.team1.name}`;
                gameState.playoff.series[key1] = { team1: 0, team2: 0 };
                gameState.playoff.series[key2] = { team1: 0, team2: 0 };
            });
            
            gameState.playoff.teams = playoffTeams.map(team => ({
                ...team,
                index: gameState.teams.findIndex(t => t.name === team.name)
            }));
            
            gameState.playoff.matchesPlayed = {};
            gameState.playoff.teams.forEach(teamData => {
                gameState.playoff.matchesPlayed[teamData.index] = 0;
            });
            
            generatePlayoffCalendar();
            
            showScreen('playoffScreen');
            updatePlayoffLeaderboard();
            updatePlayoffSchedule();
            updateCalendar();
        }

        function checkPlayoffEnd() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∫–æ–º–∞–Ω–¥–∞ —Å 7+ –æ—á–∫–∞–º–∏
            const teamsWith7Points = gameState.playoff.teams.filter(teamData => {
                const team = gameState.teams[teamData.index];
                return team.points >= 7;
            });
            
            if (teamsWith7Points.length > 0) {
                // –ù–∞—Ö–æ–¥–∏–º —á–µ–º–ø–∏–æ–Ω–∞ (–∫–æ–º–∞–Ω–¥—É —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ—á–∫–æ–≤)
                const championTeam = teamsWith7Points.reduce((prev, current) => {
                    const prevTeam = gameState.teams[prev.index];
                    const currentTeam = gameState.teams[current.index];
                    return currentTeam.points > prevTeam.points ? current : prev;
                });
                
                gameState.playoff.champion = championTeam;
                showChampionScreen();
            }
        }

        function showSeasonEndScreen() {
            const sortedTeams = [...gameState.teams].sort((a, b) => b.points - a.points);
            const champion = sortedTeams[0];
            
            document.getElementById('seasonEndText').innerHTML = `
                <div>–í–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –ø—Ä–æ—à–ª–∞ –≤ –ø–ª–µ–π-–æ—Ñ—Ñ</div>
                <div style="margin-top: 20px; font-size: 1.5em;">üèÜ –ß–µ–º–ø–∏–æ–Ω: ${champion.emoji} ${champion.name}</div>
            `;
            
            showScreen('seasonEndScreen');
        }

        function showChampionScreen() {
            const champion = gameState.playoff.champion;
            const championTeam = gameState.teams[champion.index];
            document.getElementById('championText').innerHTML = `
                <div>üéâ –ü–û–ë–ï–î–ò–¢–ï–õ–¨ –ö–£–ë–ö–ê –õ–û–•! üéâ</div>
                <div style="margin-top: 20px; font-size: 1.5em;">${championTeam.emoji} ${championTeam.name}</div>
            `;
            showScreen('championScreen');
        }

        function startNewSeason() {
            gameState.season.year++;
            gameState.season.stage = 'regular';
            gameState.season.matchesPlayed = {};
            gameState.teams.forEach((team, index) => {
                gameState.season.matchesPlayed[index] = 0;
            });
            
            // –°–ë–†–ê–°–´–í–ê–ï–ú –°–¢–ê–¢–ò–°–¢–ò–ö–£ –ö–û–ú–ê–ù–î –î–õ–Ø –ù–û–í–û–ì–û –°–ï–ó–û–ù–ê
            gameState.teams.forEach(team => {
                team.points = 0;
                team.wins = 0;
                team.losses = 0;
                team.games = 0;
            });
            
            gameState.season.calendar.currentDate = new Date(gameState.season.year, 8, 1);
            gameState.season.calendar.currentWeek = 1;
            gameState.playerBudget = 0;
            
            // –ü–ï–†–ï–ì–ï–ù–ï–†–ò–†–£–ï–ú –ö–ê–õ–ï–ù–î–ê–†–¨ –î–õ–Ø –ù–û–í–û–ì–û –°–ï–ó–û–ù–ê
            generateSeasonCalendar();
            
            updateSeasonInfo();
            updateCalendar();
            updateDailySchedule();
            updateTeamManagement();
            updateMainScreenLeaderboard();
            
            showScreen('teamManagement');
        }

        function showScreen(screenName) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenName).classList.add('active');
        }

        function addToMatchLog(message) {
            const matchLog = document.getElementById('matchLog');
            const logEntry = document.createElement('div');
            logEntry.innerHTML = message;
            matchLog.appendChild(logEntry);
            matchLog.scrollTop = matchLog.scrollHeight;
        }

        function openMarket() {
            showScreen('playerMarket');
            updateMarket();
        }

        function closeMarket() {
            if (gameState.season.stage === 'regular') {
                showScreen('teamManagement');
            } else {
                showScreen('playoffScreen');
            }
        }

        function updateMarket() {
            const marketPlayers = document.getElementById('marketPlayers');
            marketPlayers.innerHTML = '';
            
            document.getElementById('marketBudget').textContent = gameState.playerBudget.toLocaleString();
            
            gameState.freeAgents.forEach((player, index) => {
                const marketItem = document.createElement('div');
                marketItem.className = 'market-item';
                marketItem.innerHTML = `
                    <div><span class="player-emoji">${player.emoji}</span> ${player.name}</div>
                    <div>${player.isGoalie ? '–°–ó–í: ' + player.SZ : '–°–ê: ' + player.SA + ' –°–ó: ' + player.SZ}</div>
                    <div>üíµ ${player.cost.toLocaleString()} –†–£–ë</div>
                `;
                marketItem.onclick = () => buyPlayer(index);
                marketPlayers.appendChild(marketItem);
            });
        }

        function buyPlayer(playerIndex) {
            const player = gameState.freeAgents[playerIndex];
            
            if (gameState.playerBudget >= player.cost) {
                gameState.playerBudget -= player.cost;
                gameState.teams[gameState.playerTeam].players.push(player);
                gameState.freeAgents.splice(playerIndex, 1);
                
                updateMarket();
                updateTeamManagement();
                alert(`‚úÖ ${player.name} –∫—É–ø–ª–µ–Ω –∑–∞ ${player.cost.toLocaleString()} –†–£–ë`);
            } else {
                alert('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!');
            }
        }

        window.onload = initGame;
    </script>
</body>
</html>